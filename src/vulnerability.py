from src.consts import FIELDS
from datetime import datetime


class Vulnerability:
    """class representing a vulnerability"""

    __slots__ = FIELDS
    # for saving memory

    def __init__(
        self,
        title: str,
        cve_id: str,
        ack: str,
        date: datetime,
        data_url: str = "",
        display_url: str = "",
        desc: str = "",
        cvss: float = 0,
        exploited: str = "",
    ):
        self.title = title
        self.cve_id = cve_id
        self.ack = ack
        self.date = date
        self.data_url = data_url
        self.display_url = display_url
        self.desc = desc
        self.cvss = cvss
        self.exploited = exploited

    def list_of_attrs(self):
        return [getattr(self, attr) for attr in self.__slots__]

    def __repr__(self):
        attrs = {attr: getattr(self, attr) for attr in self.__slots__}
        return "<{klass} @{id:x} {attrs}>".format(
            klass=self.__class__.__name__,
            id=id(self) & 0xFFFFFF,
            attrs=" ".join("{}={!r}".format(k, v) for k, v in attrs.items()),
        )
